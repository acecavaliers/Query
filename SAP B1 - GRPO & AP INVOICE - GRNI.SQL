


SELECT DISTINCT

T0.DOCNUM AS 'GRPO Number',
T0.TAXDATE AS 'Document Date',
T0.DOCDATE AS 'Posting Date',
(SELECT
ST0.CREDIT
FROM JDT1 ST0 
INNER JOIN OACT ST1 ON ST0.ACCOUNT = ST1.ACCTCODE
INNER JOIN OJDT ST2 ON ST2.NUMBER = ST0.TRANSID
WHERE ST1.ACCTNAME LIKE '%GOODS RECEIVED NOT INVOICED-KOR%' AND ST2.BASEREF = T0.DOCNUM AND ST0.CREDIT > 0) AS GNIAMOUNT1,
T3.DOCNUM AS 'A/P Invoice Number',
T3.TAXDATE AS 'Document Date',
T3.DOCDATE AS 'Posting Date',
(SELECT
ST0.DEBIT
FROM JDT1 ST0 
INNER JOIN OACT ST1 ON ST0.ACCOUNT = ST1.ACCTCODE
INNER JOIN OJDT ST2 ON ST2.NUMBER = ST0.TRANSID
WHERE ST1.ACCTNAME LIKE '%GOODS RECEIVED NOT INVOICED-KOR%' AND ST2.BASEREF = T3.DOCNUM AND ST0.DEBIT > 0) AS GNIAMOUNT2
FROM OPDN T0
INNER JOIN PDN1 T1 ON T0.DOCNUM = T1.DocEntry
INNER JOIN PCH1 T2 ON T0.DOCNUM = T2.BASEREF
INNER JOIN OPCH T3 ON T3.DOCNUM = T2.DOCENTRY
WHERE T0.CANCELED = 'N' AND T3.CANCELED = 'N' AND T3.DOCTYPE = 'I'
ORDER BY [GRPO Number] ASC